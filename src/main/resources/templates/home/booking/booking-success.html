<!DOCTYPE html>
<html
  lang="vi"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:sec="http://www.thymeleaf.org/extras/springsecurity6"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đặt Vé Thành Công - FCine</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/booking-success.css" />
    <link
      rel="icon"
      href="https://res.cloudinary.com/thaidev/image/upload/v1752116653/favicon_ij2fnu.png"
      type="image/png"
    />
  </head>

  <body>
    <div class="container">
      <div class="header">
        <div class="success-badge">
          <i class="bi bi-check-circle-fill"></i>
          Đặt vé thành công
        </div>
        <h1 class="page-title">Cảm ơn bạn đã đặt vé!</h1>
        <p class="page-subtitle">
          Vé điện tử đã được gửi về email của bạn. Vui lòng mang theo mã vé khi
          đến rạp.
        </p>
      </div>

      <div class="main-content">
        <div class="content-section">
          <div class="section-title">
            <i class="bi bi-ticket-detailed-fill"></i>
            Thông Tin Vé Điện Tử
          </div>

          <div class="ticket-card">
            <div class="ticket-header">
              <div class="ticket-id">
                <i class="bi bi-upc-scan"></i>
                <span th:text="${ticketId}"></span>
              </div>
              <div class="ticket-status">
                <i class="bi bi-check-circle"></i>
                Đã thanh toán
              </div>
            </div>

            <div class="movie-info">
              <div class="movie-poster">
                <img
                  th:src="${movie.getSmallImage() != null ? movie.getSmallImage() : 'https://images-cdn.ubuy.vn/6351bacfdf4640089c3e6bf2-spider-man-no-way-home-2021-new-movie.jpg'}"
                  alt="Movie Poster"
                />
              </div>
              <div class="movie-details">
                <h3 th:text="${movie.getMovieNameVn()}">
                  Spider-Man: No Way Home
                </h3>
                <div class="movie-meta">
                  <div>
                    <i class="bi bi-calendar3"></i>
                    <span
                      th:text="${#temporals.format(showDate, 'EEEE, dd/MM/yyyy')}"
                      >Thứ 5, 11/06/2025</span
                    >
                  </div>
                  <div>
                    <i class="bi bi-clock"></i>
                    <span th:text="${#temporals.format(showTime, 'HH:mm')}"
                      >20:30</span
                    >
                  </div>
                  <div>
                    <i class="bi bi-geo-alt"></i>
                    <span th:text="${roomName}">Phòng 3 - 2D</span>
                  </div>
                  <div>
                    <i class="bi bi-person"></i>
                    <span th:text="${#lists.size(seats)}">2 vé</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="ticket-details">
              <div class="detail-item">
                <div class="detail-label">Ngày chiếu</div>
                <div
                  class="detail-value"
                  th:text="${#temporals.format(showDate, 'EEEE, dd/MM/yyyy')}"
                >
                  Thứ 5, 11/06/2025
                </div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Giờ chiếu</div>
                <div
                  class="detail-value"
                  th:text="${#temporals.format(showTime, 'HH:mm')}"
                >
                  20:30
                </div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Phòng chiếu</div>
                <div class="detail-value" th:text="${roomName}">
                  Phòng 3 - 2D
                </div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Ghế</div>
                <div class="detail-value">
                  <div class="seats-display-inline">
                    <span th:each="seat, iterStat : ${seats}">
                      <span
                        class="seat-badge-inline"
                        th:text="${seat.seatColRow}"
                        >C3</span
                      >
                      <span th:if="${!iterStat.last}"> </span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="thank-you-section">
            <h4>
              <i class="bi bi-envelope-heart"></i>
              Cảm ơn bạn!
            </h4>
            <p>Chúc bạn có những phút giây thư giãn tuyệt vời tại FCine</p>
          </div>
        </div>

        <!-- Payment Summary -->
        <div class="content-section">
          <div class="section-title">
            <i class="bi bi-receipt-cutoff"></i>
            Chi Tiết Thanh Toán
          </div>

          <div class="payment-summary">
            <div class="payment-method">
              <img
                src="https://itviec.com/rails/active_storage/representations/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBM0E3SHc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--3873048b5c25240e612222d38b001c927993024c/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCem9MWm05eWJXRjBTU0lJY0c1bkJqb0dSVlE2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFJc0FXa0NMQUU9IiwiZXhwIjpudWxsLCJwdXIiOiJ2YXJpYXRpb24ifX0=--15c3f2f3e11927673ae52b71712c1f66a7a1b7bd/MoMo%20Logo.png"
                alt="MoMo Logo"
                style="width: 50px; height: 50px"
              />
              <div class="payment-info">
                <h4>Thanh toán MoMo</h4>
                <p>Giao dịch thành công</p>
              </div>
              <div style="margin-left: auto; color: #22c55e; font-size: 20px">
                <i class="bi bi-check-circle-fill payment-success-icon"></i>
              </div>
            </div>

            <div class="price-breakdown">
              <div class="price-item" th:each="seat : ${seats}">
                <span
                  th:text="${seat.seatColRow != null ? (seat.seatColRow.contains('VIP') ? 'Ghế VIP (' + seat.seatColRow + ')' : 'Ghế thường (' + seat.seatColRow + ')') : 'Ghế không xác định'}"
                >
                  Ghế thường (C3)
                </span>
              </div>
              <div class="total-amount">
                <span>Tổng thanh toán</span>
                <span
                  id="totalAmount"
                  th:if="${totalAmount != null}"
                  th:text="${#numbers.formatDecimal(totalAmount, 0, 'COMMA', 0, 'POINT') + 'đ'}"
                ></span>
              </div>
            </div>
          </div>

          <div class="note-section">
            <h4>
              <i class="bi bi-info-circle"></i>
              Lưu ý quan trọng
            </h4>
            <ul>
              <li>Vui lòng có mặt tại rạp trước giờ chiếu 15 phút</li>
              <li>Mang theo mã vé để check-in</li>
              <li>Không được hoàn vé sau khi đã thanh toán</li>
              <li>Liên hệ hotline: 1900-6017 nếu cần hỗ trợ</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <a href="#" class="action-btn btn-primary" onclick="window.print()">
          <i class="bi bi-printer"></i>
          In vé
        </a>

        <a
          th:href="@{/home}"
          class="action-btn btn-secondary"
          sec:authorize="hasRole('USER')"
        >
          <i class="bi bi-arrow-left"></i>
          Về trang chủ
        </a>
        <a
          th:href="@{/employee/booking}"
          class="action-btn btn-secondary"
          sec:authorize="hasRole('EMPLOYEE')"
        >
          <i class="bi bi-arrow-left"></i>
          Quay lại đặt vé
        </a>
      </div>
    </div>
  </body>
  <script th:src="@{/js/booking-success.js}"></script>
</html>
